# edge-stock-driver
这是一个样例项目，用于展示如何基于edge-device-driver开发自己driver，目前实现了定时查询上证股票行情。

## 使用方法
1. 将edge-stock-driver项目中etc/resources目录拷贝至edge-device-manager的etc目录下
2. 启动edge-device-manager以及edge-stock-driver
3. 监听mqtt服务器就可以看到定时会有行情消息打印到

```bash
$ mosquitto_sub -h 127.0.0.1 -p 1883 -t '#' -v
# driver "stock" 状态 
META/v1/UP/stock/STATUS/ {"hello":false,"protocol":{"id":"stock","name":"stock","desc":"Stock Price From Xueqiu","category":"tick","language":"ch","support_funcs":["property","event","method"],"aux_props":null,"device_props":null},"state":"running","state_detail":""}
# device "SH600000" 状态
DATA/v1/UP/stock/SH600000/stock_sh/-/STATUS/ {"device":{"id":"SH600000","name":"浦发银行","desc":"浦发银行","product_id":"stock_sh","product_name":"上证股票","category":"tick","recording":false,"device_status":"connected","device_props":{},"device_labels":null,"device_meta":null},"state":"connected","state_detail":""}
# device "SH600000" props定时推送 (通过Watch定时查询)
DATA/v1/UP/stock/stock_sh/SH600000/*/PROPS/ {"amount":{"name":"amount","type":"float64","value":156027072.8,"ts":"2021-12-24T20:54:45.4110568+08:00"},"amplitude":{"name":"amplitude","type":"float64","value":0.7,"ts":"2021-12-24T20:54:45.4105451+08:00"},"avg_price":{"name":"avg_price","type":"float64","value":8.548469344371657,"ts":"2021-12-24T20:54:45.4105451+08:00"},"bid_appl_seq_num":{"name":"bid_appl_seq_num","type":"\u003cnil\u003e","value":null,"ts":"2021-12-24T20:54:45.4105451+08:00"},"chg":{"name":"chg","type":"float64","value":-0.04,"ts":"2021-12-24T20:54:45.4110568+08:00"},"current":{"name":"current","type":"float64","value":8.54,"ts":"2021-12-24T20:54:45.4105451+08:00"},"current_year_percent":{"name":"current_year_percent","type":"float64","value":-7.32,"ts":"2021-12-24T20:54:45.4105451+08:00"},"float_market_capital":{"name":"float_market_capital","type":"float64","value":250667494070,"ts":"2021-12-24T20:54:45.4105451+08:00"},"high":{"name":"high","type":"float64","value":8.59,"ts":"2021-12-24T20:54:45.4105451+08:00"},"is_trade":{"name":"is_trade","type":"bool","value":false,"ts":"2021-12-24T20:54:45.4105451+08:00"},"last_close":{"name":"last_close","type":"float64","value":8.58,"ts":"2021-12-24T20:54:45.4105451+08:00"},"level":{"name":"level","type":"float64","value":2,"ts":"2021-12-24T20:54:45.4105451+08:00"},"low":{"name":"low","type":"float64","value":8.53,"ts":"2021-12-24T20:54:45.4105451+08:00"},"market_capital":{"name":"market_capital","type":"float64","value":250667494070,"ts":"2021-12-24T20:54:45.4105451+08:00"},"offer_appl_seq_num":{"name":"offer_appl_seq_num","type":"\u003cnil\u003e","value":null,"ts":"2021-12-24T20:54:45.4105451+08:00"},"open":{"name":"open","type":"float64","value":8.58,"ts":"2021-12-24T20:54:45.4105451+08:00"},"percent":{"name":"percent","type":"float64","value":-0.47,"ts":"2021-12-24T20:54:45.4105451+08:00"},"side":{"name":"side","type":"\u003cnil\u003e","value":null,"ts":"2021-12-24T20:54:45.4105451+08:00"},"symbol":{"name":"symbol","type":"string","value":"SH600000","ts":"2021-12-24T20:54:45.4105451+08:00"},"timestamp":{"name":"timestamp","type":"float64","value":1640329200000,"ts":"2021-12-24T20:54:45.4105451+08:00"},"trade_session":{"name":"trade_session","type":"\u003cnil\u003e","value":null,"ts":"2021-12-24T20:54:45.4105451+08:00"},"trade_type":{"name":"trade_type","type":"\u003cnil\u003e","value":null,"ts":"2021-12-24T20:54:45.4105451+08:00"},"trade_type_v2":{"name":"trade_type_v2","type":"\u003cnil\u003e","value":null,"ts":"2021-12-24T20:54:45.4105451+08:00"},"trade_unique_id":{"name":"trade_unique_id","type":"\u003cnil\u003e","value":null,"ts":"2021-12-24T20:54:45.4105451+08:00"},"trade_volume":{"name":"trade_volume","type":"\u003cnil\u003e","value":null,"ts":"2021-12-24T20:54:45.4105451+08:00"},"traded_amount_ext":{"name":"traded_amount_ext","type":"\u003cnil\u003e","value":null,"ts":"2021-12-24T20:54:45.4105451+08:00"},"turnover_rate":{"name":"turnover_rate","type":"float64","value":0.06,"ts":"2021-12-24T20:54:45.4105451+08:00"},"type":{"name":"type","type":"float64","value":11,"ts":"2021-12-24T20:54:45.4105451+08:00"},"volume":{"name":"volume","type":"float64","value":18252048,"ts":"2021-12-24T20:54:45.4110568+08:00"},"volume_ext":{"name":"volume_ext","type":"\u003cnil\u003e","value":null,"ts":"2021-12-24T20:54:45.4105451+08:00"}}
```